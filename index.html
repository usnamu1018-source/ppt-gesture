<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>Fist â†’ PowerPoint Control</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body { font-family: Arial; text-align: center; background: #111; color: #fff; }
    video { display: none; }
    #status { margin-top: 20px; font-size: 18px; }
  </style>
</head>
<body>
  <h2>ğŸ‘Š ì£¼ë¨¹ì„ ì¥ë©´ PowerPoint ìŠ¬ë¼ì´ë“œ ë„˜ê¸°ê¸°</h2>
  <p>PowerPointë¥¼ ì „ì²´í™”ë©´(F5)ìœ¼ë¡œ ë„ìš°ê³ , ì´ í˜ì´ì§€ë¥¼ ì¼œë‘ì„¸ìš”.</p>
  <div id="status">ëª¨ë¸ ë¡œë”© ì¤‘...</div>
  <video id="webcam" autoplay playsinline width="320" height="240"></video>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>
  <script>
  const MODEL_PATH = 'model/';
  const FIST_CLASS = 'first';
  const PROB_THRESHOLD = 0.85;
  const COOLDOWN_MS = 1500;
  let model, webcam, lastTrigger = 0;
  const statusEl = document.getElementById('status');

async function init() {
  statusEl.textContent = 'ëª¨ë¸ ë¡œë“œ ì¤‘...';
  model = await tmImage.load(MODEL_PATH + 'model.json', MODEL_PATH + 'metadata.json');
  webcam = new tmImage.Webcam(320, 240, true);
  await webcam.setup();
  await webcam.play();
  document.getElementById('webcam').appendChild(webcam.canvas);
  statusEl.textContent = 'ì¤€ë¹„ ì™„ë£Œ. ì£¼ë¨¹ì„ ì¥ì–´ë³´ì„¸ìš”.';
  window.requestAnimationFrame(loop);
}

  async function loop() {
    webcam.update();
    await predict();
    window.requestAnimationFrame(loop);
  }

  async function predict() {
    const predictions = await model.predict(webcam.canvas);
    const fistProb = predictions.find(p => p.className.toLowerCase() === FIST_CLASS).probability;
    statusEl.textContent = `ì£¼ë¨¹ í™•ë¥ : ${(fistProb*100).toFixed(1)}%`;
    const now = Date.now();
    if (fistProb > PROB_THRESHOLD && (now - lastTrigger) > COOLDOWN_MS) {
      lastTrigger = now;
      statusEl.textContent = "ğŸ‘‰ ë‹¤ìŒ ìŠ¬ë¼ì´ë“œ!";
      fetch('http://localhost:5000/next', { method: 'POST' });
    }
  }

  init();
  </script>
</body>
</html>

